<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>

	<!-- import the d3 library -->
	<!-- <script type="text/javascript" src="https://d3js.org/d3.v5.min.js"></script> -->
    <script type='text/javascript' src='lib/d3.v5.min.js'></script>

	<!-- style sheet -->
	<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
	<div id="chart"></div>
	<script>
		let chart = d3.select("#chart"),
			originalData = null,
			data = null,
			selected = {};

		// display the loaded dataset
		/*
		d3.csv("src/dataset_song_count.csv").then(function(data){
			chart
				.selectAll("p")
				.data(data)
				.enter()
        		.append("p")
				.text(function(d) {
					 rep = d.name + ", " + d.title;
           			 return rep;
        		});
		});
		*/

		d3.csv("src/dataset_song_count.csv").then(file =>{
			originalData = file
			data = originalData
			displayChart()
		});

		/*
		function filterData(data) {
			console.log("KKKKKKKKKKKKKKK")
			let artists = data.filter(d => d.name === "A")
			console.log("HHHHHHH")
			console.log(artists.title)
			return {
				'artists': artists
			}
		}
		*/

		function displayChart() {
			// set the dimensions and margins of the graph
			var margin = {top: 10, right: 30, bottom: 30, left: 60},
				width = 1000 - margin.left - margin.right,
				height = 800 - margin.top - margin.bottom;

			var lineOpacity = "0.25";
			var lineOpacityHover = "0.85";
			var otherLinesOpacityHover = "0.1";
			var lineStroke = "1.5px";
			var lineStrokeHover = "2.5px";

			var circleOpacity = '0.85';
			var circleOpacityOnLineHover = "0.25"
			var circleRadius = 3;
			var circleRadiusHover = 6;


			// format numerical values
			var parseDate = d3.timeFormat("%Y");
			data.forEach(function(d) { 
				d.year = +d.year;
				d.rank = +d.rank;    
				d.song_count_per_year = +d.song_count_per_year;   
				d.song_count_per_period = +d.song_count_per_period; 
			});

			// append the svg object to the body of the page
			var svg = d3.select("#chart")
			.append("svg")
				.attr("width", width + margin.left + margin.right)
				.attr("height", height + margin.top + margin.bottom)
			.append("g")
				.attr("transform",
					"translate(" + margin.left + "," + margin.top + ")");

			var sumstat = d3.nest() 
						.key(function(d) { return d['location.country'];})
						.entries(data)

			// Add X axis --> it is a date format
			var years = [1910, 1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923, 1924, 1925,
			 1926, 1927, 1928, 1929, 1930, 1931, 1932, 1933, 1934, 1935, 1936, 1937, 1938, 1939, 1940, 1941, 1942, 1943,
			  1944, 1945, 1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961,
			   1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 
			   1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997,
			    1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
				 2016, 2017]
			// Create a linear scale to transform the data
			var x = d3.scaleLinear()
				.domain(d3.extent(years))
				.range([0, width]);

			// Append an X-axis group to the SVG
			var xAxis = svg.append("g")
				.attr("transform", "translate(0," + height + ")")
				.call(d3.axisBottom(x).ticks(10).tickFormat(d3.format("d"))); // Use d3.format to format the tick labels as integers



			// Add Y axis
			var y = d3.scaleLinear()
				.domain([0, d3.max(data, function(d) { return d.song_count_per_year; })])
				.range([ height, 0 ]);
			svg.append("g")
				.call(d3.axisLeft(y));

			// color palette
			var color = d3.scaleOrdinal(d3.schemeCategory10);

			/*
			// Draw the line
			svg.selectAll(".line")
				.data(sumstat)
				.enter()
				.append("path")
					.attr("fill", "none")
					.attr("stroke", function(d){ return color(d.key) })
					.attr("stroke-width", 1.5)
					.attr("d", function(d){
					return d3.line()
						.x(function(d) { return x(d.year); })
						.y(function(d) { return y(d.song_count_per_year); })
						(d.values)
					})

					*/


		}

	</script>

</body>
</html>